{"remainingRequest":"D:\\U3W-AIProject_false\\U3W-AI\\cube-ui\\node_modules\\babel-loader\\lib\\index.js!D:\\U3W-AIProject_false\\U3W-AI\\cube-ui\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\U3W-AIProject_false\\U3W-AI\\cube-ui\\src\\utils\\websocket.js","dependencies":[{"path":"D:\\U3W-AIProject_false\\U3W-AI\\cube-ui\\src\\utils\\websocket.js","mtime":1752382983655},{"path":"D:\\U3W-AIProject_false\\U3W-AI\\cube-ui\\babel.config.js","mtime":1752382983593},{"path":"D:\\U3W-AIProject_false\\U3W-AI\\cube-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1752387764959},{"path":"D:\\U3W-AIProject_false\\U3W-AI\\cube-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":1752387764613},{"path":"D:\\U3W-AIProject_false\\U3W-AI\\cube-ui\\node_modules\\eslint-loader\\index.js","mtime":1752387759336}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCJEOi9VM1ctQUlQcm9qZWN0X2ZhbHNlL1UzVy1BSS9jdWJlLXVpL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2ludGVyb3BSZXF1aXJlRGVmYXVsdC5qcyIpLmRlZmF1bHQ7Ck9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwOwpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIik7CnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5qc29uLnN0cmluZ2lmeS5qcyIpOwp2YXIgX2NsYXNzQ2FsbENoZWNrMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiRDovVTNXLUFJUHJvamVjdF9mYWxzZS9VM1ctQUkvY3ViZS11aS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9jbGFzc0NhbGxDaGVjay5qcyIpKTsKdmFyIF9jcmVhdGVDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIkQ6L1UzVy1BSVByb2plY3RfZmFsc2UvVTNXLUFJL2N1YmUtdWkvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvY3JlYXRlQ2xhc3MuanMiKSk7CnZhciBXZWJTb2NrZXRDbGllbnQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIFdlYlNvY2tldENsaWVudCgpIHsKICAgICgwLCBfY2xhc3NDYWxsQ2hlY2syLmRlZmF1bHQpKHRoaXMsIFdlYlNvY2tldENsaWVudCk7CiAgICB0aGlzLndzID0gbnVsbDsKICAgIHRoaXMubWVzc2FnZUNhbGxiYWNrID0gbnVsbDsKICAgIHRoaXMucmVjb25uZWN0QXR0ZW1wdHMgPSAwOwogICAgdGhpcy5tYXhSZWNvbm5lY3RBdHRlbXB0cyA9IDU7CiAgICB0aGlzLnJlY29ubmVjdEludGVydmFsID0gMzAwMDsgLy8gM+enkumHjei/numXtOmalAogIH0KCiAgLy8g5Yid5aeL5YyWV2ViU29ja2V06L+e5o6lCiAgcmV0dXJuICgwLCBfY3JlYXRlQ2xhc3MyLmRlZmF1bHQpKFdlYlNvY2tldENsaWVudCwgW3sKICAgIGtleTogImNvbm5lY3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvbm5lY3QodXJsLCBtZXNzYWdlQ2FsbGJhY2spIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKICAgICAgdGhpcy5tZXNzYWdlQ2FsbGJhY2sgPSBtZXNzYWdlQ2FsbGJhY2s7CiAgICAgIHRyeSB7CiAgICAgICAgdGhpcy53cyA9IG5ldyBXZWJTb2NrZXQodXJsKTsKICAgICAgICB0aGlzLndzLm9ub3BlbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdXZWJTb2NrZXTov57mjqXmiJDlip8nKTsKICAgICAgICAgIF90aGlzLnJlY29ubmVjdEF0dGVtcHRzID0gMDsgLy8g6YeN572u6YeN6L+e5qyh5pWwCiAgICAgICAgICBpZiAoX3RoaXMubWVzc2FnZUNhbGxiYWNrKSB7CiAgICAgICAgICAgIF90aGlzLm1lc3NhZ2VDYWxsYmFjayh7CiAgICAgICAgICAgICAgdHlwZTogJ29wZW4nCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgdGhpcy53cy5vbm1lc3NhZ2UgPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgIGlmIChfdGhpcy5tZXNzYWdlQ2FsbGJhY2spIHsKICAgICAgICAgICAgX3RoaXMubWVzc2FnZUNhbGxiYWNrKHsKICAgICAgICAgICAgICB0eXBlOiAnbWVzc2FnZScsCiAgICAgICAgICAgICAgZGF0YTogZXZlbnQuZGF0YQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIHRoaXMud3Mub25jbG9zZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdXZWJTb2NrZXTov57mjqXlhbPpl60nKTsKICAgICAgICAgIGlmIChfdGhpcy5tZXNzYWdlQ2FsbGJhY2spIHsKICAgICAgICAgICAgX3RoaXMubWVzc2FnZUNhbGxiYWNrKHsKICAgICAgICAgICAgICB0eXBlOiAnY2xvc2UnCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgICAgX3RoaXMucmVjb25uZWN0KHVybCk7CiAgICAgICAgfTsKICAgICAgICB0aGlzLndzLm9uZXJyb3IgPSBmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1dlYlNvY2tldOi/nuaOpemUmeivrzonLCBlcnJvcik7CiAgICAgICAgICBpZiAoX3RoaXMubWVzc2FnZUNhbGxiYWNrKSB7CiAgICAgICAgICAgIF90aGlzLm1lc3NhZ2VDYWxsYmFjayh7CiAgICAgICAgICAgICAgdHlwZTogJ2Vycm9yJywKICAgICAgICAgICAgICBlcnJvcjogZXJyb3IKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCdXZWJTb2NrZXTliJ3lp4vljJbplJnor686JywgZXJyb3IpOwogICAgICAgIHRoaXMucmVjb25uZWN0KHVybCk7CiAgICAgIH0KICAgIH0KCiAgICAvLyDph43ov57mnLrliLYKICB9LCB7CiAgICBrZXk6ICJyZWNvbm5lY3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlY29ubmVjdCh1cmwpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIGlmICh0aGlzLnJlY29ubmVjdEF0dGVtcHRzIDwgdGhpcy5tYXhSZWNvbm5lY3RBdHRlbXB0cykgewogICAgICAgIHRoaXMucmVjb25uZWN0QXR0ZW1wdHMrKzsKICAgICAgICBjb25zb2xlLmxvZygiXHU1QzFEXHU4QkQ1XHU5MUNEXHU4RkRFICgiLmNvbmNhdCh0aGlzLnJlY29ubmVjdEF0dGVtcHRzLCAiLyIpLmNvbmNhdCh0aGlzLm1heFJlY29ubmVjdEF0dGVtcHRzLCAiKS4uLiIpKTsKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzMi5jb25uZWN0KHVybCwgX3RoaXMyLm1lc3NhZ2VDYWxsYmFjayk7CiAgICAgICAgfSwgdGhpcy5yZWNvbm5lY3RJbnRlcnZhbCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS5sb2coJ+i+vuWIsOacgOWkp+mHjei/nuasoeaVsO+8jOWBnOatoumHjei/nicpOwogICAgICAgIGlmICh0aGlzLm1lc3NhZ2VDYWxsYmFjaykgewogICAgICAgICAgdGhpcy5tZXNzYWdlQ2FsbGJhY2soewogICAgICAgICAgICB0eXBlOiAncmVjb25uZWN0X2ZhaWxlZCcKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIC8vIOWPkemAgea2iOaBrwogIH0sIHsKICAgIGtleTogInNlbmQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNlbmQoZGF0YSkgewogICAgICBpZiAodGhpcy53cyAmJiB0aGlzLndzLnJlYWR5U3RhdGUgPT09IFdlYlNvY2tldC5PUEVOKSB7CiAgICAgICAgdGhpcy53cy5zZW5kKHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJyA/IGRhdGEgOiBKU09OLnN0cmluZ2lmeShkYXRhKSk7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8vIOWFs+mXrei/nuaOpQogIH0sIHsKICAgIGtleTogImNsb3NlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9zZSgpIHsKICAgICAgaWYgKHRoaXMud3MpIHsKICAgICAgICB0aGlzLndzLmNsb3NlKCk7CiAgICAgICAgdGhpcy53cyA9IG51bGw7CiAgICAgIH0KICAgIH0KCiAgICAvLyDojrflj5bov57mjqXnirbmgIEKICB9LCB7CiAgICBrZXk6ICJnZXRTdGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0U3RhdGUoKSB7CiAgICAgIGlmICghdGhpcy53cykgcmV0dXJuIFdlYlNvY2tldC5DTE9TRUQ7CiAgICAgIHJldHVybiB0aGlzLndzLnJlYWR5U3RhdGU7CiAgICB9CiAgfV0pOwp9KCk7IC8vIOWIm+W7uuWNleS+i+WunuS+iwp2YXIgd2Vic29ja2V0Q2xpZW50ID0gbmV3IFdlYlNvY2tldENsaWVudCgpOwp2YXIgX2RlZmF1bHQgPSBleHBvcnRzLmRlZmF1bHQgPSB3ZWJzb2NrZXRDbGllbnQ7"},{"version":3,"names":["WebSocketClient","_classCallCheck2","default","ws","messageCallback","reconnectAttempts","maxReconnectAttempts","reconnectInterval","_createClass2","key","value","connect","url","_this","WebSocket","onopen","console","log","type","onmessage","event","data","onclose","reconnect","onerror","error","_this2","concat","setTimeout","send","readyState","OPEN","JSON","stringify","close","getState","CLOSED","websocketClient","_default","exports"],"sources":["D:/U3W-AIProject_false/U3W-AI/cube-ui/src/utils/websocket.js"],"sourcesContent":["class WebSocketClient {\r\n  constructor() {\r\n    this.ws = null;\r\n    this.messageCallback = null;\r\n    this.reconnectAttempts = 0;\r\n    this.maxReconnectAttempts = 5;\r\n    this.reconnectInterval = 3000; // 3秒重连间隔\r\n  }\r\n\r\n  // 初始化WebSocket连接\r\n  connect(url, messageCallback) {\r\n    this.messageCallback = messageCallback;\r\n    \r\n    try {\r\n      this.ws = new WebSocket(url);\r\n\r\n      this.ws.onopen = () => {\r\n        console.log('WebSocket连接成功');\r\n        this.reconnectAttempts = 0; // 重置重连次数\r\n        if (this.messageCallback) {\r\n          this.messageCallback({ type: 'open' });\r\n        }\r\n      };\r\n\r\n      this.ws.onmessage = (event) => {\r\n        if (this.messageCallback) {\r\n          this.messageCallback({ type: 'message', data: event.data });\r\n        }\r\n      };\r\n\r\n      this.ws.onclose = () => {\r\n        console.log('WebSocket连接关闭');\r\n        if (this.messageCallback) {\r\n          this.messageCallback({ type: 'close' });\r\n        }\r\n        this.reconnect(url);\r\n      };\r\n\r\n      this.ws.onerror = (error) => {\r\n        console.error('WebSocket连接错误:', error);\r\n        if (this.messageCallback) {\r\n          this.messageCallback({ type: 'error', error });\r\n        }\r\n      };\r\n    } catch (error) {\r\n      console.error('WebSocket初始化错误:', error);\r\n      this.reconnect(url);\r\n    }\r\n  }\r\n\r\n  // 重连机制\r\n  reconnect(url) {\r\n    if (this.reconnectAttempts < this.maxReconnectAttempts) {\r\n      this.reconnectAttempts++;\r\n      console.log(`尝试重连 (${this.reconnectAttempts}/${this.maxReconnectAttempts})...`);\r\n      \r\n      setTimeout(() => {\r\n        this.connect(url, this.messageCallback);\r\n      }, this.reconnectInterval);\r\n    } else {\r\n      console.log('达到最大重连次数，停止重连');\r\n      if (this.messageCallback) {\r\n        this.messageCallback({ type: 'reconnect_failed' });\r\n      }\r\n    }\r\n  }\r\n\r\n  // 发送消息\r\n  send(data) {\r\n    if (this.ws && this.ws.readyState === WebSocket.OPEN) {\r\n      this.ws.send(typeof data === 'string' ? data : JSON.stringify(data));\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  // 关闭连接\r\n  close() {\r\n    if (this.ws) {\r\n      this.ws.close();\r\n      this.ws = null;\r\n    }\r\n  }\r\n\r\n  // 获取连接状态\r\n  getState() {\r\n    if (!this.ws) return WebSocket.CLOSED;\r\n    return this.ws.readyState;\r\n  }\r\n}\r\n\r\n// 创建单例实例\r\nconst websocketClient = new WebSocketClient();\r\n\r\nexport default websocketClient; "],"mappings":"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","ignoreList":[]}]}